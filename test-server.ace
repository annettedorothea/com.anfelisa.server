com.anfelisa.test

target JAVA

models {
	persistent Test (
		Unique PrimaryKey NotNull Serial id
		NotNull String name
		Integer sequence
		NotNull Integer lessonId references com.anfelisa.lesson.Lesson.id
		NotNull String html
		NotNull String author references com.anfelisa.user.User.username
	)
	LessonId (
		NotNull Integer lessonId
	)
	TestId (
		NotNull Integer testId
	)
	MyTest (
		NotNull Serial id
		NotNull String name
		Integer sequence
		Integer resultCount
		Boolean hasResults
	)
	(
		List com.anfelisa.result.ResultAbstract
	)
}

data {
	TestCreation : ( Test )
	TestList : (List Test LessonId com.anfelisa.lesson.LessonAbstract com.anfelisa.course.CourseAbstract)
	Test : ( Test TestId LessonId com.anfelisa.lesson.LessonAbstract com.anfelisa.course.CourseAbstract List Test) 
	MyTestList : (List MyTest LessonId com.anfelisa.user.Username com.anfelisa.lesson.LessonAbstract com.anfelisa.course.CourseAbstract)
	MyTest : ( Test TestId LessonId com.anfelisa.user.Username com.anfelisa.lesson.LessonAbstract com.anfelisa.course.CourseAbstract List MyTest) 
}

actions {
	POST CreateTest uses TestCreation executes CreateTest
	GET LoadPublicTests uses TestList
	GET LoadPublicTest uses Test
	GET LoadPrivateTests uses MyTestList
	GET LoadPrivateTest uses MyTest
}

commands {
	CreateTest uses TestCreation {
		on created publishes ( TestCreated )
	}
}

events {
	TestCreated uses TestCreation listenedToBy ( Test.createTest )
}

views {
	Test {
		createTest (TestCreation)
	}
}
